<?php
 goto rY3TW; Z0yq4: ?>
;var e=<?php  goto dEL0X; NwELz: ?>
<!doctypehtml><html lang="en"><head><meta charset="UTF-8"><meta content="width=device-width,initial-scale=1"name="viewport"><title>Alors On Danse</title><link href="index.css"rel="stylesheet"type="text/css"></head><body><header><h1>Alors On Danse</h1><nav><div id="timer">30:00</div></nav></header><div style="padding:20px"><h2>Vulnerability: Command Injection</h2><h3>Level 7</h3><button id="submitKeyBtn">Who am I?</button><div class="vulnerable_code_area"><h2>Ping a device</h2><form action="#"method="post"name="ping"><p>Enter an IP address: <input name="ip"size="30"> <input name="Submit"type="submit"value="Submit"></p></form><?php  goto vwRB1; DTAL9: ?>
Alors On Danse</p></footer><script>function startTimer(e,t){var n,r,o=e,u=setInterval(function(){n=parseInt(o/60,10),r=parseInt(o%60,10),n=n<10?"0"+n:n,r=r<10?"0"+r:r,t.textContent=n+":"+r,--o<0&&(clearInterval(u),setTimeout(function(){window.location.href="index.php"},1e3))},1e3)}window.onload=function(){<?php  goto fLCDT; fLCDT: $duration = isset($_SESSION["\164\x69\155\145\162"]) ? $_SESSION["\x74\x69\155\145\162"] : 60; goto Z0yq4; im0qG: $_SESSION["\x63\x68\x61\x6c\x6c\x65\x6e\147\x65\x5f\x63\x6f\155\x70\x6c\x65\x74\x65"] = true; goto Ispc4; gy1PE: if (!$_SESSION["\x61\x75\x74\150\145\x6e\164\151\143\x61\164\x65\144"] || !$_SESSION["\x63\x68\141\x6c\154\145\x6e\147\145\137\143\157\155\160\x6c\x65\164\x65"]) { header("\114\157\x63\141\164\151\157\156\72\40\x6c\157\147\151\x6e\x2e\160\x68\160"); die; } goto vc176; vwRB1: echo $html; goto dF0AD; rY3TW: session_start(); goto fH5td; Ispc4: ?>
,window.location.href="guestbook.php")})</script></div></div><footer><p>Â©<?php  goto TYXkZ; fH5td: $_SESSION["\x74\x69\155\x65\x72"] = 1800; goto gy1PE; RItTl: $_SESSION["\x74\151\x6d\x65\x72"] = "\74\x73\x63\x72\151\x70\x74\76\144\157\143\x75\155\x65\156\x74\56\167\x72\x69\x74\x65\50\144\165\162\x61\x74\151\157\x6e\x29\x3b\x3c\x2f\x73\143\x72\151\x70\164\x3e"; goto AbaT3; pdkuh: if (isset($_POST["\x53\165\142\155\151\x74"])) { $target = $_REQUEST["\x69\160"]; $substitutions = array("\x26\x26" => '', "\73" => ''); $target = str_replace(array_keys($substitutions), $substitutions, $target); if (stristr(php_uname("\163"), "\x57\x69\156\x64\157\167\x73\x20\x4e\x54")) { $cmd = shell_exec("\x70\x69\x6e\147\x20\x20" . $target); } else { $cmd = shell_exec("\x70\x69\156\x67\40\x20\x2d\x63\40\64\x20" . $target); } $html .= "\74\160\162\145\x3e{$cmd}\74\57\x70\162\x65\x3e"; } goto NwELz; WypAo: ?>
,t=document.querySelector("#timer");startTimer(e,t),setInterval(function(){e-=1,<?php  goto RItTl; azONe: $_SESSION["\143\150\x61\x6c\154\145\156\x67\145\x5f\143\157\155\160\x6c\145\164\x65"] = false; goto pdkuh; dEL0X: echo $duration; goto WypAo; dF0AD: ?>
<script>document.getElementById("submitKeyBtn").addEventListener("click",function(){var e=prompt();null!==e&&""!==e&&"www-data"===e&&(<?php  goto im0qG; vc176: $html = ''; goto azONe; TYXkZ: echo date("\131"); goto DTAL9; AbaT3: ?>
},1e3)}</script></body></html>